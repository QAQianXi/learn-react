import{y as s,r as e,da as t,j as a,db as r,d7 as n,d8 as o,a7 as i,a8 as l,I as c}from"./index-b1b3d88f.js";import d from"./kanban-column-66afb8d3.js";import{T as m,a as u,D as p}from"./kanban-task-48bab853.js";import"./task-detail-fdc21a7f.js";import"./dayjs.min-0adc8d86.js";import"./index-fa5ce600.js";import"./CheckOutlined-7754a19c.js";import"./styleChecker-9f7ab8c8.js";import"./index-15da099d.js";import"./index-89a86bdf.js";import"./index-118c91f5.js";import"./index-8fbc16fd.js";import"./index-3bce57f1.js";import"./index-c86577dd.js";import"./addEventListener-f1ef07f1.js";import"./index-3b5b5826.js";import"./useIcons-d7dc163e.js";import"./List-7bacef27.js";const k=e=>{const t=[];for(let a=0;a<e;a+=1)t.push({username:s.person.fullName(),avatar:s.image.avatarLegacy(),content:s.lorem.lines({min:1,max:3}),time:s.date.past()});return t},g=e=>{const t=[];for(let a=0;a<e;a+=1)t.push(s.image.urlPicsumPhotos());return t},f=e=>{const t=[];for(let a=0;a<e;a+=1)t.push(s.image.avatarLegacy());return t},x=e=>{const t=[],a=new Set;for(;t.length<e;){const e=s.helpers.enumValue(u);a.has(e)||(t.push(e),a.add(e))}return t},j={tasks:{"task-1":{id:"task-1",title:s.lorem.words(3),reporter:s.image.avatarLegacy(),priority:m.LOW,tags:[],comments:[],attachments:[]},"task-2":{id:"task-2",title:s.lorem.words(3),reporter:s.image.avatarLegacy(),assignee:f(1),date:s.date.future(),priority:m.HIGH,tags:x(3),comments:k(1),attachments:g(4)},"task-3":{id:"task-3",title:s.lorem.words(4),reporter:s.image.avatarLegacy(),assignee:f(2),priority:m.MEDIUM,date:s.date.future(),tags:x(2),comments:k(2),attachments:[]},"task-4":{id:"task-4",title:s.lorem.words(5),reporter:s.image.avatar(),assignee:f(3),priority:m.MEDIUM,tags:x(3),date:s.date.future(),description:s.lorem.lines(5),attachments:[],comments:k(3)},"task-5":{id:"task-5",title:s.lorem.words(4),reporter:s.image.avatar(),priority:m.HIGH,assignee:f(4),tags:x(4),date:s.date.future(),description:s.lorem.lines(3),attachments:[],comments:k(4)},"task-6":{id:"task-6",title:s.lorem.words(5),reporter:s.image.avatar(),priority:m.LOW,assignee:f(5),tags:x(5),date:s.date.future(),description:s.lorem.lines(4),attachments:g(5),comments:k(4)}},columns:{"column-1":{id:"column-1",title:"To do",taskIds:["task-1","task-2","task-3"]},"column-2":{id:"column-2",title:"In progress",taskIds:["task-4","task-5"]},"column-3":{id:"column-3",title:"Done",taskIds:["task-6"]}},columnOrder:["column-1","column-2","column-3"]};function I(){const[m,u]=e.useState(j),[k,g]=e.useState(!1),f=e.useRef(null);t("click",(e=>{if(f.current&&!f.current.input?.contains(e.target)){const e=f.current.input?.value;e&&x({id:s.string.uuid(),title:e,taskIds:[]}),g(!1)}}));const x=s=>{const e={...m,columns:{...m.columns,[s.id]:s},columnOrder:[...m.columnOrder,s.id]};u(e)},I=(s,e)=>{const t=m.columns[s],a={...m,tasks:{...m.tasks,[e.id]:e},columns:{...m.columns,[s]:{...t,taskIds:[...t.taskIds,e.id]}}};u(a)},h=s=>{const e=m.columns[s],t=Object.keys(m.tasks).filter((s=>!e.taskIds.includes(s))).reduce(((s,e)=>(s[e]=m.tasks[e],s)),{}),a=Object.keys(m.columns).filter((e=>e!==s)).reduce(((s,e)=>(s[e]=m.columns[e],s)),{}),r=Array.from(m.columnOrder).filter((e=>e!==s));u({tasks:t,columns:a,columnOrder:r})},y=s=>{const e=m.columns[s],t=Object.keys(m.tasks).filter((s=>!e.taskIds.includes(s))).reduce(((s,e)=>(s[e]=m.tasks[e],s)),{}),a={...m.columns,[s]:{...e,taskIds:[]}},r={...m,tasks:t,columns:a};u(r)},b=s=>{const{id:e,title:t}=s,a={...m.columns,[e]:{...m.columns[e],title:t}},r={...m,columns:a};u(r)};return a.jsx(r,{children:a.jsxs("div",{className:"flex",children:[a.jsx(n,{onDragEnd:s=>{const{source:e,destination:t,type:a}=s;t&&(t.droppableId===e.droppableId&&t.index===e.index||(a===p.COLUMN?(s=>{const{source:e,destination:t,draggableId:a}=s,r=Array.from(m.columnOrder);r.splice(e.index,1),r.splice(t.index,0,a);const n={...m,columnOrder:r};u(n)})(s):(s=>{const{source:e,destination:t,draggableId:a}=s,r=m.columns[e.droppableId],n=m.columns[t.droppableId];if(r===n){const s=Array.from(r.taskIds);s.splice(e.index,1),s.splice(t.index,0,a);const n={...r,taskIds:s},o={...m,columns:{...m.columns,[n.id]:n}};u(o)}else{const s=Array.from(r.taskIds);s.splice(e.index,1);const o={...r,taskIds:s},i=Array.from(n.taskIds);i.splice(t.index,0,a);const l={...n,taskIds:i},c={...m,columns:{...m.columns,[o.id]:o,[l.id]:l}};u(c)}})(s)))},children:a.jsx(o,{droppableId:"all-columns",direction:"horizontal",type:p.COLUMN,children:s=>a.jsxs("div",{ref:s.innerRef,...s.droppableProps,className:"flex h-full items-start gap-6 p-1",children:[m.columnOrder.map(((s,e)=>{const t=m.columns[s],r=t.taskIds.map((s=>m.tasks[s]));return a.jsx(d,{index:e,column:t,tasks:r,createTask:I,clearColumn:y,deleteColumn:h,renameColumn:b},s)})),s.placeholder]})})}),a.jsx("div",{className:"ml-[1.6rem] mt-[0.25rem] min-w-[280px]",children:k?a.jsx(i,{ref:f,size:"large",placeholder:"Column Name",autoFocus:!0}):a.jsxs(l,{onClick:s=>{s.stopPropagation(),g(!0)},className:"!inline-flex !w-full items-center justify-center !text-xs !font-semibold",block:!0,size:"large",children:[a.jsx(c,{icon:"carbon:add",size:20}),a.jsx("div",{children:"Add Column"})]})})]})})}export{I as default};
